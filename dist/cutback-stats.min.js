!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CutbackStats={})}(this,function(e){"use strict";e.Stats=class{#e=null;#t=[];#i=null;#n={};#s={initX:0,initY:0,mousePressX:0,mousePressY:0};constructor(e=null){this.#i=e,window.addEventListener("load",()=>{this.initializeStats()})}initializeStats(){this.buildStats(),this.cacheElements(),this.addHoverEffects(),this.setTimeline()}setTimeline(){const e=this.#i||window.banner;e?(this.#i=e,this.#t=e.timelinesArray||[],0!==this.#t.length?(this.#e=this.#t[0],this.registerEventHandlers(),this.fillTimelinesSelect()):console.warn("Stats: No timelines found in banner")):console.warn("Stats: No banner instance found")}buildStats(){const e=document.querySelector(".banner");if(!e)return void console.warn("Stats: No .banner element found");const t=document.createElement("div");t.id="stats",Object.assign(t.style,{width:"300px",height:"130px",backgroundColor:"#ccc",position:"fixed",bottom:"0",right:"0",opacity:"0.5",borderRadius:"10px",zIndex:"9999"}),t.addEventListener("mouseover",()=>{t.style.opacity="1"}),t.addEventListener("mouseout",()=>{t.style.opacity="0.5"}),t.innerHTML='\n      <p id="currenttime" style="font-family: Arial, sans-serif; color: #666; font-size: 30px; position: absolute; bottom: 85px; left: 14px; opacity: 0.5; margin: 0;">00.00</p>\n      <p id="totaltime" style="font-family: Arial, sans-serif; color: #666; font-size: 20px; position: absolute; bottom: 88px; left: 101px; opacity: 0.5; margin: 0;">00.00</p>\n      <input id="slider-timeline" type="range" min="0" step="0.01" max="274" value="0" style="position: absolute; bottom: 60px; width: 274px; left: 10px;">\n      <select id="flags" style="position: absolute; bottom: 20px; right: 14px; width: 120px;"></select>\n      <select id="timelines" style="position: absolute; bottom: 90px; right: 14px; width: 120px;"></select>\n      <span id="play" style="font-family: Arial, sans-serif; color: #fff; font-size: 16px; position: absolute; bottom: 10px; left: 14px; cursor: pointer; background-color: #999; padding: 10px 8px; border-radius: 10px; width: 46px; text-align: center;">Play</span>\n      <span id="restart" style="font-family: Arial, sans-serif; color: #fff; font-size: 16px; position: absolute; bottom: 10px; left: 84px; cursor: pointer; background-color: #999; padding: 10px 8px; border-radius: 10px;">Restart</span>\n    ',e.parentNode.insertBefore(t,e.nextSibling)}cacheElements(){this.#n={statDiv:document.getElementById("stats"),playButton:document.getElementById("play"),restartButton:document.getElementById("restart"),sliderTimeline:document.getElementById("slider-timeline"),selectFlags:document.getElementById("flags"),selectTimelines:document.getElementById("timelines"),totalTimeDisplay:document.getElementById("totaltime"),currentTimeDisplay:document.getElementById("currenttime")}}addHoverEffects(){const{playButton:e,restartButton:t}=this.#n;e&&(e.addEventListener("mouseover",()=>{e.style.backgroundColor="#666666"}),e.addEventListener("mouseout",()=>{e.style.backgroundColor="#999999"})),t&&(t.addEventListener("mouseover",()=>{t.style.backgroundColor="#666666"}),t.addEventListener("mouseout",()=>{t.style.backgroundColor="#999999"}))}registerEventHandlers(){const{statDiv:e,playButton:t,restartButton:i,selectFlags:n,selectTimelines:s,sliderTimeline:l}=this.#n;e&&e.addEventListener("mousedown",e=>this.handleDragStart(e)),t&&t.addEventListener("click",()=>this.togglePlay()),i&&i.addEventListener("click",()=>this.restartTimeline()),n&&n.addEventListener("change",()=>this.goToLabel()),s&&s.addEventListener("change",()=>this.switchTimeline()),l&&(l.addEventListener("input",()=>this.scrubTimeline()),l.addEventListener("change",()=>this.scrubTimeline()))}handleDragStart(e){const{statDiv:t,sliderTimeline:i}=this.#n;if(e.target===i)return;this.#s={initX:t.offsetLeft,initY:t.offsetTop,mousePressX:e.clientX,mousePressY:e.clientY};const n=e=>this.handleDragMove(e);t.addEventListener("mousemove",n),window.addEventListener("mouseup",()=>{t.removeEventListener("mousemove",n),t.style.cursor="default"},{once:!0})}handleDragMove(e){const{statDiv:t}=this.#n,{initX:i,initY:n,mousePressX:s,mousePressY:l}=this.#s;t.style.cursor="move",t.style.left=i+e.clientX-s+"px",t.style.top=n+e.clientY-l+"px",t.style.right="auto",t.style.bottom="auto"}togglePlay(){const{playButton:e}=this.#n;this.#e&&(this.#e.paused()?(this.#e.totalDuration()===this.#e.time()?this.#e.restart():this.#e.play(),e.textContent="Pause"):(this.#e.pause(),e.textContent="Play"))}restartTimeline(){this.#e&&this.#e.restart()}goToLabel(){const{selectFlags:e}=this.#n;if(this.#e&&e){const t=e.options[e.selectedIndex].text;this.#e.seek(t).play()}}scrubTimeline(){const{sliderTimeline:e,currentTimeDisplay:t}=this.#n;this.#e&&e&&(this.#e.seek(parseFloat(e.value)),t.textContent=this.#e.time().toFixed(2))}switchTimeline(){const{selectTimelines:e,sliderTimeline:t}=this.#n;if(!e)return;this.#e&&this.#e.seek(0);const i=e.options[e.selectedIndex].value;this.#e=this.#t[parseInt(i,10)],t&&(t.value="0"),this.updateTimelineDisplay()}fillTimelinesSelect(){const{selectTimelines:e}=this.#n,t=this.#i;if(!e||!t)return;const i=(t.timelinesName||[]).map((e,t)=>`<option value="${t}">${e}</option>`).join("");e.innerHTML=i;for(const e of this.#t)e.eventCallback("onStart",()=>this.handleTimelineStart(e));this.updateTimelineDisplay()}handleTimelineStart(e){const{selectTimelines:t}=this.#n;this.#e=e;const i=this.#t.indexOf(e);t&&i>=0&&(t.selectedIndex=i),this.updateTimelineDisplay()}updateTimelineDisplay(){const{selectFlags:e,currentTimeDisplay:t,totalTimeDisplay:i,sliderTimeline:n}=this.#n;if(this.#e){if(e){const t=(this.#e.getLabelsArray?.()||[]).map(e=>`<option value="${e.time}">${e.name}</option>`).join("");e.innerHTML=t}t&&(t.textContent=this.#e.time().toFixed(2)),i&&(i.textContent=this.#e.totalDuration().toFixed(2)),n&&(n.max=this.#e.totalDuration().toFixed(2)),this.#e.eventCallback("onUpdate",()=>this.handleTimelineUpdate()),this.#e.eventCallback("onComplete",()=>this.handleTimelineComplete())}}handleTimelineUpdate(){const{currentTimeDisplay:e,sliderTimeline:t,playButton:i}=this.#n;if(!this.#e)return;const n=this.#e.time().toFixed(2);e&&(e.textContent=n),t&&(t.value=n),i&&(i.textContent="Pause")}handleTimelineComplete(){const{playButton:e}=this.#n;e&&(e.textContent="Play"),this.#e&&this.#e.pause()}getCurrentTimeline(){return this.#e}setBanner(e){this.#i=e,this.setTimeline()}}});
